{"remainingRequest":"/Users/eripha/Desktop/project/routine/admin/node_modules/babel-loader/lib/index.js!/Users/eripha/Desktop/project/routine/admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/eripha/Desktop/project/routine/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/eripha/Desktop/project/routine/admin/src/views/CategoryList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/eripha/Desktop/project/routine/admin/src/views/CategoryList.vue","mtime":1593323206976},{"path":"/Users/eripha/Desktop/project/routine/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/eripha/Desktop/project/routine/admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/eripha/Desktop/project/routine/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/eripha/Desktop/project/routine/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXRlbXM6IFtdCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgLy/ph43mlrDosIPnlKgKICAgIGZldGNoOiBmdW5jdGlvbiBmZXRjaCgpIHsKICAgICAgdmFyIHJlczsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBmZXRjaCQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCh0aGlzLiRodHRwLmdldCgnL3Jlc3QvY2F0ZWdvcmllcycpKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICByZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgIHRoaXMuaXRlbXMgPSByZXMuZGF0YTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgbnVsbCwgdGhpcyk7CiAgICB9LAogICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUocm93KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmFzeW5jKGZ1bmN0aW9uIHJlbW92ZSQoX2NvbnRleHQzKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgdGhpcy4kY29uZmlybSgiXHU2NjJGXHU1NDI2XHU4OTgxXHU1MjIwXHU5NjY0XHU1MjA2XHU3QzdCIi5jb25jYXQocm93Lm5hbWUpLCAn5o+Q56S6JywgewogICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVzOwogICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dDIpIHsKICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLmF3cmFwKF90aGlzLiRodHRwLmRlbGV0ZSgiL3Jlc3QvY2F0ZWdvcmllcy8iLmNvbmNhdChyb3cuX2lkKSkpOwoKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLml0ZW1zID0gcmVzLmRhdGE7CgogICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfliKDpmaTmiJDlip8hJwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmZldGNoKCk7CgogICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIG51bGwsIHRoaXMpOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZmV0Y2goKTsKICB9Cn07"},{"version":3,"sources":["CategoryList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAqBA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,KAAA,EAAA;AADA,KAAA;AAGA,GALA;AAMA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,KAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CAGA,KAAA,KAAA,CAAA,GAAA,CAAA,kBAAA,CAHA;;AAAA;AAGA,cAAA,GAHA;AAIA,mBAAA,KAAA,GAAA,GAAA,CAAA,IAAA;;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA,IAAA,MANA,kBAMA,GANA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAOA,mBAAA,QAAA,qDAAA,GAAA,CAAA,IAAA,GAAA,IAAA,EAAA;AACA,gBAAA,iBAAA,EAAA,IADA;AAEA,gBAAA,gBAAA,EAAA,IAFA;AAGA,gBAAA,IAAA,EAAA;AAHA,eAAA,EAIA,IAJA,CAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wDAEA,KAAA,CAAA,KAAA,CAAA,MAAA,4BAAA,GAAA,CAAA,GAAA,EAFA;;AAAA;AAEA,wBAAA,GAFA;AAGA,wBAAA,KAAA,CAAA,KAAA,GAAA,GAAA,CAAA,IAAA;;AACA,wBAAA,KAAA,CAAA,QAAA,CAAA;AACA,0BAAA,IAAA,EAAA,SADA;AAEA,0BAAA,OAAA,EAAA;AAFA,yBAAA;;AAIA,wBAAA,KAAA,CAAA,KAAA;;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAJA;;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GANA;AA6BA,EAAA,OA7BA,qBA6BA;AACA,SAAA,KAAA;AACA;AA/BA,CAAA","sourcesContent":["<template>\n  <div>\n    <h1>分类列表</h1>\n    <el-table :data=\"items\">\n      <el-table-column prop=\"_id\" label=\"ID\" width=\"230\"></el-table-column>\n      <!-- 后端接口添加了populate方法，把parent变成了一个对象，以此来获取它的name。否则prop=parent只能拿到它的id -->\n      <el-table-column prop=\"parent.name\" label=\"上级分类\"></el-table-column>\n      <el-table-column prop=\"name\" label=\"标题\"></el-table-column>\n      <el-table-column prop=\"path\" label=\"路径\"></el-table-column>\n      <el-table-column fixed=\"right\" label=\"操作\" width=\"180\">\n        <template slot-scope=\"scope\">\n          <!-- scope表示当前行 -->\n          <el-button @click=\"$router.push(`/categories/edit/${scope.row._id}`)\" type=\"text\" size=\"small\">编辑</el-button>\n          <el-button @click=\"remove(scope.row)\" type=\"text\" size=\"small\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script>\nexport default {\n  data () {\n    return {\n      items: []\n    }\n  },\n  methods: {\n    //重新调用\n    async fetch () {\n      const res = await this.$http.get('/rest/categories')\n      this.items = res.data\n    },\n    async remove(row){\n      this.$confirm(`是否要删除分类${row.name}`, '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(async () => {\n          //注意这边是row_id\n          const res = await this.$http.delete(`/rest/categories/${row._id}`)\n          this.items = res.data\n          this.$message({\n            type: 'success',\n            message: '删除成功!'\n          });\n          this.fetch()\n        });\n    }\n  },\n  created () {\n    this.fetch()\n  },\n}\n</script>\n\n<style>\n.el-table{\n  line-height: normal;\n}\n</style>"],"sourceRoot":"src/views"}]}